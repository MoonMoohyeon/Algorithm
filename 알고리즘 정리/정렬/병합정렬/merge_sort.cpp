#include <iostream>
#include <vector>
#include <cstring>
using namespace std;

void merge(int a[], int left, int mid, int right); // ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ë‰œ ë°°ì—´ì„ ì •ë ¬í•˜ë©° ë³‘í•©í•˜ëŠ” í•¨ìˆ˜
void divide(int a[], int left, int right);       // ë°°ì—´ì„ ê³„ì†í•´ì„œ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜

int main(void) {
    int arr[10] = {1, 16, 8, 4, 17, 9, 3, 7, 2, 11};

    divide(arr, 0, 9);

    cout << "ì •ë ¬ëœ ë°°ì—´: ";
    for(int i = 0; i < 10; i++) {
        cout << arr[i] << " ";
    }
    cout << endl;

    return 0;
}

/**
 * @brief ë°°ì—´ì„ ì¬ê·€ì ìœ¼ë¡œ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜ (Divide ìª¼ê°œê¸°)
 * @param a ì •ë ¬í•  ì›ë³¸ ë°°ì—´
 * @param left ë¶„í• í•  ë°°ì—´ì˜ ì‹œì‘ ì¸ë±ìŠ¤
 * @param right ë¶„í• í•  ë°°ì—´ì˜ ë ì¸ë±ìŠ¤
 */
void divide(int a[], int left, int right) {
    // ì¬ê·€ í˜¸ì¶œì˜ ì¢…ë£Œ ì¡°ê±´: ë°°ì—´ì˜ í¬ê¸°ê°€ 1 ì´í•˜ì´ë©´ ë” ì´ìƒ ë‚˜ëˆŒ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.
    // (right - left + 1)ì€ í˜„ì¬ ë°°ì—´ ë¶€ë¶„ì˜ í¬ê¸°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
    if ((right - left + 1) <= 1) return;

    // ë°°ì—´ì˜ ì¤‘ê°„ ì§€ì  ì¸ë±ìŠ¤ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    // (left + right) / 2ëŠ” ì •ìˆ˜ ë‚˜ëˆ—ì…ˆì„ í†µí•´ ì¤‘ê°„ ì¸ë±ìŠ¤ë¥¼ êµ¬í•©ë‹ˆë‹¤.
    int mid = (left + right) / 2;

    // ì¬ê·€ í˜¸ì¶œì„ í†µí•´ ì™¼ìª½ ë¶€ë¶„ì„ ë‹¤ì‹œ ë‚˜ëˆ•ë‹ˆë‹¤. (left ~ mid)
    divide(a, left, mid);

    // ì¬ê·€ í˜¸ì¶œì„ í†µí•´ ì˜¤ë¥¸ìª½ ë¶€ë¶„ì„ ë‹¤ì‹œ ë‚˜ëˆ•ë‹ˆë‹¤. (mid + 1 ~ right)
    divide(a, mid + 1, right);

    // ë‚˜ëˆ„ì–´ì§„ ë‘ ë¶€ë¶„ì„ ì •ë ¬í•˜ë©´ì„œ ë‹¤ì‹œ í•˜ë‚˜ë¡œ ë³‘í•©í•©ë‹ˆë‹¤. (Conquer & Combine í•©ì¹˜ê¸°)
    merge(a, left, mid, right);
}

/**
 * @brief ë‘ ê°œì˜ ì •ë ¬ëœ ë¶€ë¶„ ë°°ì—´ì„ í•˜ë‚˜ì˜ ì •ë ¬ëœ ë°°ì—´ë¡œ ë³‘í•©í•˜ëŠ” í•¨ìˆ˜ (Merge í•©ì¹˜ê¸°)
 * @param a ì •ë ¬í•  ì›ë³¸ ë°°ì—´
 * @param left ì™¼ìª½ ë¶€ë¶„ ë°°ì—´ì˜ ì‹œì‘ ì¸ë±ìŠ¤
 * @param mid ì™¼ìª½ ë¶€ë¶„ ë°°ì—´ì˜ ë ì¸ë±ìŠ¤ (ê²½ê³„ì„ )
 * @param right ì˜¤ë¥¸ìª½ ë¶€ë¶„ ë°°ì—´ì˜ ë ì¸ë±ìŠ¤
 */
void merge(int a[], int left, int mid, int right) {
    // ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ ë¶€ë¶„ ë°°ì—´ì˜ í¬ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    int leftSize = mid - left + 1;
    int rightSize = right - mid;

    // ğŸ”¹ ì„ì‹œ ë°°ì—´ ìƒì„±
    // ì •ë ¬ëœ ê²°ê³¼ë¥¼ ë‹´ì„ ì„ì‹œ ë°°ì—´ì„ C++ vectorë¥¼ ì‚¬ìš©í•´ ë§Œë“­ë‹ˆë‹¤.
    vector<int> leftArr(leftSize);
    vector<int> rightArr(rightSize);

    // ğŸ”¹ ë°ì´í„° ë³µì‚¬
    // memcpyë¥¼ ì‚¬ìš©í•˜ì—¬ ì›ë³¸ ë°°ì—´(a)ì˜ ë°ì´í„°ë¥¼ ì„ì‹œ ë°°ì—´ë¡œ ë¹ ë¥´ê²Œ ë³µì‚¬í•©ë‹ˆë‹¤.
    // leftArr.data()ëŠ” vectorì˜ ë‚´ë¶€ ë°°ì—´ í¬ì¸í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    memcpy(leftArr.data(), a + left, leftSize * sizeof(int));
    memcpy(rightArr.data(), a + mid + 1, rightSize * sizeof(int));

    int i = 0;      // leftArrì˜ ì¸ë±ìŠ¤
    int j = 0;      // rightArrì˜ ì¸ë±ìŠ¤
    int k = left;   // ì›ë³¸ ë°°ì—´ aì— ì •ë ¬ëœ ê°’ì„ ì±„ì›Œë„£ì„ ìœ„ì¹˜ì˜ ì¸ë±ìŠ¤

    // ğŸ”¹ ë³‘í•© ê³¼ì • (Merge)
    // ë‘ ì„ì‹œ ë°°ì—´ì˜ ìš”ì†Œë¥¼ ë¹„êµí•˜ë©° ì‘ì€ ê°’ì„ ì›ë³¸ ë°°ì—´ aì— ìˆœì„œëŒ€ë¡œ ë„£ìŠµë‹ˆë‹¤.
    while (i < leftSize && j < rightSize) {
        // ì™¼ìª½ ë°°ì—´ì˜ í˜„ì¬ ê°’ì´ ì˜¤ë¥¸ìª½ ë°°ì—´ì˜ í˜„ì¬ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìœ¼ë©´
        if (leftArr[i] <= rightArr[j]) {
            a[k++] = leftArr[i++]; // ì™¼ìª½ ê°’ì„ ì›ë³¸ ë°°ì—´ì— ë„£ê³ , ì¸ë±ìŠ¤ iì™€ kë¥¼ 1 ì¦ê°€ì‹œí‚µë‹ˆë‹¤.
        } else { // ì˜¤ë¥¸ìª½ ë°°ì—´ì˜ í˜„ì¬ ê°’ì´ ë” ì‘ìœ¼ë©´
            a[k++] = rightArr[j++]; // ì˜¤ë¥¸ìª½ ê°’ì„ ì›ë³¸ ë°°ì—´ì— ë„£ê³ , ì¸ë±ìŠ¤ jì™€ kë¥¼ 1 ì¦ê°€ì‹œí‚µë‹ˆë‹¤.
        }
    }

    // ğŸ”¹ ë‚¨ì€ ìš”ì†Œ ë³µì‚¬
    // ìœ„ whileë¬¸ì´ ëë‚œ í›„, ë‘˜ ì¤‘ í•˜ë‚˜ì˜ ë°°ì—´ì—ëŠ” ì•„ì§ ìš”ì†Œê°€ ë‚¨ì•„ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    // ë‚¨ì•„ìˆëŠ” ìš”ì†Œë“¤ì„ ì›ë³¸ ë°°ì—´ aì˜ ë’·ë¶€ë¶„ì— ìˆœì„œëŒ€ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤.

    // ì™¼ìª½ ë°°ì—´ì— ìš”ì†Œê°€ ë‚¨ì•„ìˆë‹¤ë©´
    while (i < leftSize) {
        a[k++] = leftArr[i++];
    }
    // ì˜¤ë¥¸ìª½ ë°°ì—´ì— ìš”ì†Œê°€ ë‚¨ì•„ìˆë‹¤ë©´
    while (j < rightSize) {
        a[k++] = rightArr[j++];
    }
}